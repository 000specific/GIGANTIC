# GIGANTIC STEP_3 Phylogenetic Analysis Configuration
# AI: Claude Code | Opus 4.6 | 2026 February 27 | Purpose: User-editable configuration for phylogenetic analysis
# Human: Eric Edsinger

# ============================================================
# QUICK START
# ============================================================
# Each workflow copy processes ONE gene family.
# 1. Copy the template:
#    cp -r workflow-COPYME-phylogenetic_analysis workflow-RUN_01-phylogenetic_analysis
# 2. Edit this config file (set gene_family name)
# 3. Ensure STEP_2 has completed (AGS files in output_to_input/)
# 4. Choose tree-building methods below (tree_methods section)
# 5. Run: bash RUN-workflow.sh

# ============================================================
# GENE FAMILY (EDIT THIS)
# ============================================================

gene_family:
  # Name of the gene family being analyzed (must match STEP_2 output)
  name: "innexin_pannexin"

# ============================================================
# INPUT CONFIGURATION
# ============================================================

input:
  # Path to STEP_2 AGS sequences (relative to this workflow directory)
  # Default: looks in STEP_2 output_to_input
  step2_ags_fastas_dir: "../../STEP_2-homolog_discovery/output_to_input/ags_fastas"

# ============================================================
# PROJECT SETTINGS
# ============================================================

project:
  name: "gene_families"
  database: "species67_T1-species67"

# ============================================================
# TREE-BUILDING METHODS
# ============================================================
# Enable/disable each tree-building method.
# At least one method must be enabled.

tree_methods:
  # FastTree: Fast approximate ML phylogeny (DEFAULT, RECOMMENDED)
  # Good for: General-purpose phylogenetics, 50-500 sequences
  # Quality: Best approximate ML trees (better log-likelihoods than VeryFastTree)
  # Runtime: Minutes to hours
  fasttree: true

  # IQ-TREE: Full ML phylogeny with model selection and bootstrap
  # Good for: Publication-quality analysis, rigorous statistical support
  # Runtime: Hours to days (depends on dataset size)
  iqtree: false

  # VeryFastTree: Parallelized FastTree replacement
  # Good for: Very large datasets (>10,000 sequences) where threading helps
  # Quality: Slightly worse trees than FastTree at typical GIGANTIC scale
  # Runtime: Similar to FastTree for small datasets, faster for very large ones
  veryfasttree: false

  # PhyloBayes: Bayesian phylogenetic inference (CAT-GTR model)
  # Good for: Bayesian counterpoint to ML methods, deep divergences
  # Quality: Site-heterogeneous models, posterior probability support
  # Runtime: Very slow (days to weeks) - runs 2 MCMC chains + convergence check
  phylobayes: false

# ============================================================
# MAFFT ALIGNMENT PARAMETERS
# ============================================================

phylogenetics:
  mafft:
    maxiterate: 1000
    reorder: true
    bl: 45
    originalseqonly: true
    threads: 50

  # ClipKit alignment trimming
  clipkit:
    mode: "smart-gap"

  # IQ-TREE parameters (only used when iqtree: true above)
  iqtree:
    model: "MFP"       # Model finder plus (automatic model selection)
    bootstrap: 2000    # Ultrafast bootstrap replicates
    alrt: 2000         # SH-aLRT test replicates
    bnni: true         # Optimize branch lengths
    threads: "AUTO"    # Auto-detect thread count

  # VeryFastTree parameters (only used when veryfasttree: true above)
  veryfasttree:
    threads: 4         # Number of threads (main advantage over FastTree)

  # PhyloBayes parameters (only used when phylobayes: true above)
  phylobayes:
    model: "-cat -gtr"   # CAT-GTR site-heterogeneous model
    generations: 10000   # Total MCMC generations per chain
    burnin: 2500         # Burnin generations to discard
    every: 1             # Save every N generations

# ============================================================
# SLURM CLUSTER SETTINGS (if running via SLURM)
# ============================================================

slurm:
  account: "moroz"
  qos: "moroz"

  # MAFFT alignment resources
  mafft:
    cpus: 100
    memory: "700 GB"
    time: "100:00:00"

  # IQ-TREE resources (only used when iqtree: true)
  iqtree:
    cpus: 100
    memory: "700 GB"
    time: "100:00:00"

  # PhyloBayes resources (only used when phylobayes: true)
  phylobayes:
    cpus: 4
    memory: "32 GB"
    time: "336:00:00"    # 2 weeks (PhyloBayes is very slow)

# ============================================================
# OUTPUT CONFIGURATION
# ============================================================

output:
  base_dir: "OUTPUT_pipeline"
